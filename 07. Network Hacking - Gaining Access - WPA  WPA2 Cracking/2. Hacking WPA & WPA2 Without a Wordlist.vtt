WEBVTT

00:00.990 --> 00:04.140
Instructor: Okay, now that we know what WPS is

00:04.140 --> 00:08.250
and how it can be used to recover the password for WPA

00:08.250 --> 00:12.963
and WPA2 networks, let's see how to do that in practice.

00:14.010 --> 00:16.830
So right here I have my Kali machine.

00:16.830 --> 00:18.750
I've already enabled monitor mode

00:18.750 --> 00:21.630
on my wireless adapter on one zero.

00:21.630 --> 00:24.150
Now usually we use Aero Dump NG

00:24.150 --> 00:27.030
to see all the networks around us,

00:27.030 --> 00:29.610
but right now we want to see the networks

00:29.610 --> 00:32.100
that have WPS enabled.

00:32.100 --> 00:33.480
But because like I said

00:33.480 --> 00:37.890
it's just a feature and people can turn this feature off.

00:37.890 --> 00:39.990
So first of all I'm gonna use a tool

00:39.990 --> 00:44.430
called "wash" to display all the networks

00:44.430 --> 00:48.210
around me that have WPS enabled.

00:48.210 --> 00:52.710
So we're gonna do wash--interface

00:52.710 --> 00:55.110
and give it my interface in monitor mode,

00:55.110 --> 00:57.120
which is mon0.

00:57.120 --> 00:58.860
So all we're doing is "wash"

00:58.860 --> 01:01.050
is the name of the tool interface

01:01.050 --> 01:02.730
to give it the interface.

01:02.730 --> 01:06.600
And mon0 is my wireless adapter in monitor mode.

01:06.600 --> 01:08.100
If I hit enter now

01:08.100 --> 01:11.940
you'll see it'll list my network straight away.

01:11.940 --> 01:15.450
Now I pressed CTRL C to cancel this similar to aero dump NG

01:15.450 --> 01:18.390
because it'll keep running unless you cancel it.

01:18.390 --> 01:20.850
And you can see this is my target network.

01:20.850 --> 01:22.470
It's called Test AP.

01:22.470 --> 01:24.030
It's given us the vendor

01:24.030 --> 01:28.200
of the hardware used in this network in this access point.

01:28.200 --> 01:31.950
The Lck tell us whether WPS is locked

01:31.950 --> 01:35.100
or not because sometimes WPS locks

01:35.100 --> 01:37.650
after a number of failed attempts.

01:37.650 --> 01:39.510
So right now this says "no", which means

01:39.510 --> 01:42.960
that we can actually go ahead and try to guess the pin.

01:42.960 --> 01:44.940
It's given us the version of WPS.

01:44.940 --> 01:47.160
It's using version one.

01:47.160 --> 01:49.290
The signal strength is in here

01:49.290 --> 01:51.873
the channel and the BSSID.

01:52.800 --> 01:54.360
Now I explained the meaning of all

01:54.360 --> 01:58.020
of these things before in my aero dump NG lecture

01:58.020 --> 01:59.790
so I'm not gonna talk about them now.

01:59.790 --> 02:02.340
If you forgot the meaning of any of these terms

02:02.340 --> 02:05.163
please go back to the aero dump NG lecture.

02:06.210 --> 02:09.060
Now this network actually uses WPA2.

02:09.060 --> 02:11.820
So just to confirm this to you, if I go here

02:11.820 --> 02:15.333
to my host machine and just try to connect to it,

02:16.530 --> 02:17.790
you'll see that it's telling me

02:17.790 --> 02:21.390
that this uses a WPA2 password.

02:21.390 --> 02:25.260
But like I said, we don't care if it's WPA or WPA2

02:25.260 --> 02:28.140
because we're gonna be exploiting a feature

02:28.140 --> 02:31.593
in these encryptions, which is the WPS feature.

02:32.640 --> 02:36.990
So now that we know our target network uses WPS

02:36.990 --> 02:39.960
there's a good chance that this attack will work against it.

02:39.960 --> 02:44.460
The only reason it might fail is if the target uses PBC

02:44.460 --> 02:47.100
or push button authentication.

02:47.100 --> 02:50.010
Like I said, if the target uses PBC,

02:50.010 --> 02:51.990
then it'll refuse all the pins

02:51.990 --> 02:53.490
unless the button is pressed

02:53.490 --> 02:57.000
on the router and therefore this attack will fail.

02:57.000 --> 02:58.740
The only way to know is to literally

02:58.740 --> 03:01.083
try this attack and see if it works.

03:02.280 --> 03:04.260
So I'm gonna copy the Mac address

03:04.260 --> 03:06.453
of this network or the BSSID.

03:08.130 --> 03:09.600
And the first thing that I'm gonna do

03:09.600 --> 03:12.270
similar to what we did with WEP,

03:12.270 --> 03:15.180
I'm going to associate with the target network

03:15.180 --> 03:17.610
using a fake authentication attack.

03:17.610 --> 03:20.730
So basically I'll be saying I want to communicate with you

03:20.730 --> 03:23.850
please don't ignore me so that when I run the attack

03:23.850 --> 03:28.260
the network will start accepting the pins and not ignore me.

03:28.260 --> 03:31.380
So to associate we're gonna use the exact same command

03:31.380 --> 03:34.290
that we used when we did it with WEP.

03:34.290 --> 03:36.183
So we're gonna use aireplay-ng,

03:37.260 --> 03:38.093
we're going to tell it

03:38.093 --> 03:40.593
I want to run a fake authentication attack.

03:41.490 --> 03:43.260
We're gonna give it the delay.

03:43.260 --> 03:47.310
So this is the time to wait between association attempts.

03:47.310 --> 03:49.110
Previously we set it to zero

03:49.110 --> 03:52.080
and we have to do this manually every now and then.

03:52.080 --> 03:54.180
Right now I'm gonna set it to 30

03:54.180 --> 03:57.090
so that we associate with the target network

03:57.090 --> 03:58.743
every 30 seconds.

04:00.120 --> 04:03.270
Then I'm gonna do -a to give it the Mac address

04:03.270 --> 04:07.050
of my target and -h to give it the MAC address

04:07.050 --> 04:09.720
of my wireless adapter in monitor mode.

04:09.720 --> 04:11.310
And we see that we can get this

04:11.310 --> 04:16.310
by doing ifconfig and copy it from here.

04:16.350 --> 04:18.400
We said it's the first 12 digits

04:20.610 --> 04:24.093
and I'll just replace the minus with the column.

04:25.260 --> 04:27.210
And finally, I'm gonna give it the name

04:27.210 --> 04:30.630
of my wireless adapter in monitor mode, which is mon0.

04:32.429 --> 04:34.830
So I explained this in details before

04:34.830 --> 04:36.390
that's why I did it quickly.

04:36.390 --> 04:38.370
If you don't remember how I did this

04:38.370 --> 04:42.420
please go back to the fake authentication attack lecture.

04:42.420 --> 04:46.230
So the command is ready now, but I'm not gonna execute it.

04:46.230 --> 04:49.710
I'm gonna go down to the bottom terminal and run reaver

04:49.710 --> 04:52.260
which is the program that will brute force the pin

04:52.260 --> 04:57.180
for me and only then I will associate with the target

04:57.180 --> 05:01.530
because otherwise airereplay NG will fail to associate

05:01.530 --> 05:02.583
with my network.

05:03.840 --> 05:06.720
So I'm gonna move to this terminal right here.

05:06.720 --> 05:10.890
I'm gonna clear the screen and we're gonna run reaver

05:10.890 --> 05:14.670
which is the program that's going to brute force the pin.

05:14.670 --> 05:17.010
So it's gonna try every possible pin

05:17.010 --> 05:18.840
until it get the right pin.

05:18.840 --> 05:21.240
Once it has the right pin, it'll use it to

05:21.240 --> 05:25.260
to compute the actual WPA key.

05:25.260 --> 05:27.750
So using reaver is very, very simple.

05:27.750 --> 05:30.840
It's very similar to everything we've been doing so far.

05:30.840 --> 05:33.390
So first of all, we have to type the program name

05:33.390 --> 05:34.353
which is reaver.

05:35.790 --> 05:38.850
Then I'm gonna do --bssid to give it

05:38.850 --> 05:41.280
the Mac address of my target network.

05:41.280 --> 05:42.630
So I'm just gonna paste it.

05:43.890 --> 05:48.210
Then I'm gonna do --channel and give it the channel

05:48.210 --> 05:50.313
of the target network, which is one.

05:51.210 --> 05:54.330
Then we're gonna do --interface

05:54.330 --> 05:56.850
and give it my wireless adapter in

05:56.850 --> 05:58.890
monitor mode, which is mon0.

06:00.270 --> 06:02.310
So a very, very simple command.

06:02.310 --> 06:03.300
We're using reaver.

06:03.300 --> 06:04.890
This is the name of the program

06:04.890 --> 06:06.210
that will do the brute forcing

06:06.210 --> 06:08.220
for us and give us the key.

06:08.220 --> 06:11.820
We're giving it the BSSID, the Mac address of my target.

06:11.820 --> 06:14.730
We're doing --channel to give it the channel.

06:14.730 --> 06:17.981
That's my target is running on and we're doing

06:17.981 --> 06:20.700
-: -interface to give it the name

06:20.700 --> 06:23.373
of my wireless adapter in monitor mode.

06:24.450 --> 06:26.700
I'm also gonna add two more options.

06:26.700 --> 06:29.490
I'm gonna add -vvv

06:29.490 --> 06:32.490
to show us as much information as possible.

06:32.490 --> 06:33.690
This is really helpful.

06:33.690 --> 06:35.940
If it fails or things go wrong

06:35.940 --> 06:38.310
we'll be able to know what's happening

06:38.310 --> 06:40.440
why things are going wrong.

06:40.440 --> 06:44.620
And I'm also gonna do --no-associate

06:46.440 --> 06:48.720
to tell reaver not to associate

06:48.720 --> 06:50.130
with the target network

06:50.130 --> 06:53.850
because we're already manually doing that in here.

06:53.850 --> 06:57.360
So reaver can automatically do this step right here for you

06:57.360 --> 06:59.820
but I've seen that it fails a lot.

06:59.820 --> 07:02.700
Therefore it's actually better to do it ourselves

07:02.700 --> 07:06.513
manually here and then tell reaver not to associate.

07:07.800 --> 07:09.840
So now I'm gonna hit enter to get reaver

07:09.840 --> 07:12.510
to work and I'm gonna go up

07:12.510 --> 07:15.330
to the top terminal and I'm gonna hit "enter"

07:15.330 --> 07:17.670
to associate with the target network.

07:17.670 --> 07:19.560
Telling it please don't ignore us.

07:19.560 --> 07:23.640
So that reaver at the bottom here can brute force the pin

07:23.640 --> 07:27.960
and try every possible pin until we get the correct pin

07:27.960 --> 07:30.360
which we'll use to get the password.

07:30.360 --> 07:33.720
And as you can see, right now, reaver is trying the pin.

07:33.720 --> 07:38.720
1, 2, 3, 4, 5, 6, 7, and perfect.

07:39.000 --> 07:42.990
You can see the pin was actually 1, 2, 3, 4, 5, 6, 7, 0.

07:42.990 --> 07:44.520
So it's a simple pin.

07:44.520 --> 07:46.230
It actually came with this pin.

07:46.230 --> 07:48.300
So I didn't manually set this pin.

07:48.300 --> 07:50.370
My router came from the factory

07:50.370 --> 07:53.340
with WPS enabled with this pin.

07:53.340 --> 07:55.440
So like I said, this still works,

07:55.440 --> 07:58.200
but again not against all routers.

07:58.200 --> 08:01.380
From that, it was able to discover the WPA key

08:01.380 --> 08:04.320
which is U-A-U-R-W-S-X-R

08:04.320 --> 08:07.170
and the name of the router is Test AP.

08:07.170 --> 08:10.200
So I can literally go ahead and connect with this password

08:10.200 --> 08:12.720
and I'll be able to connect to the network

08:12.720 --> 08:16.743
and see and decrypt all of the packets sent in the air.
